!function(e){"use strict";function r(){e(t).each(function(){i(e(this)).removeClass("open")})}function i(t){var n=t.attr("data-target"),r;return n||(n=t.attr("href"),n=n&&/#/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,"")),r=e(n),r.length||(r=t.parent()),r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;return s=i(n),o=s.hasClass("open"),r(),o||(s.toggleClass("open"),n.focus()),!1},keydown:function(t){var n,r,s,o,u,a;if(!/(38|40|27)/.test(t.keyCode))return;n=e(this),t.preventDefault(),t.stopPropagation();if(n.is(".disabled, :disabled"))return;o=i(n),u=o.hasClass("open");if(!u||u&&t.keyCode==27)return n.click();r=e("[role=menu] li:not(.divider) a",o);if(!r.length)return;a=r.index(r.filter(":focus")),t.keyCode==38&&a>0&&a--,t.keyCode==40&&a<r.length-1&&a++,~a||(a=0),r.eq(a).focus()}},e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e(document).on("click.dropdown.data-api touchstart.dropdown.data-api",r).on("click.dropdown touchstart.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):this.options.trigger!="manual"&&(i=this.options.trigger=="hover"?"mouseenter":"focus",s=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show)return n.show();clearTimeout(this.timeout),n.hoverState="in",this.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(s),e.detach().css({top:0,left:0,display:"block"}).insertAfter(this.$element),n=this.getPosition(t),r=e[0].offsetWidth,i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}e.offset(o).addClass(s).addClass("in")}},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function r(){var t=setTimeout(function(){n.off(e.support.transition.end).detach()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.detach()})}var t=this,n=this.tip();return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?r():n.detach(),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);n[n.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}},e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!1}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content > *")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}}),e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(e){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(this.removeBackdrop,this)):this.removeBackdrop()):t&&t()}},e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})}(window.jQuery);var DSt=function(){var e={version:.002005,get:function(e){var t=localStorage.getItem(e);return t===undefined||t===null?t="null":t=t.toString(),JSON.parse(t)},set:function(e,t){return localStorage.setItem(e,JSON.stringify(t))},store:function(t){typeof t=="string"&&(t=document.getElementById(t));if(!t||t.name=="")return this;var n=e._form_elt_key(t);return t.type=="checkbox"?e.set(n,t.checked?1:0):t.type=="radio"?e.set(n,e._radio_value(t)):e.set(n,t.value||""),this},recall:function(t){typeof t=="string"&&(t=document.getElementById(t));if(!t||t.name=="")return this;var n=e._form_elt_key(t),r=e.get(n);return t.type=="checkbox"?t.checked=!!r:t.type=="radio"?t.value==r&&(t.checked=!0):t.value=r||"",this},_form_elt_key:function(e){return"_form_"+e.form.name+"_field_"+e.name},_radio_value:function(e){typeof e=="string"&&(e=document.getElementById(e));var t=e.form.elements[e.name],n=t.length,r=null;for(var i=0;i<n;i++)t[i].checked&&(r=t[i].value);return r},recall_form:function(t){return e._apply_fn_to_form_inputs(t,e.recall)},store_form:function(t){return e._apply_fn_to_form_inputs(t,e.store)},_apply_fn_to_form_inputs:function(e,t){typeof e=="string"&&(e=document.getElementById(e));var n=e.elements.length;for(var r=0;r<n;r++){var i=e.elements[r];(i.tagName=="TEXTAREA"||i.tagName=="INPUT"&&i.type!="file"&&i.type!="button"&&i.type!="image"&&i.type!="password"&&i.type!="submit"&&i.type!="reset")&&t(i)}return this},_storage_types:function(){var e="";for(var t in window)if(t=="sessionStorage"||t=="globalStorage"||t=="localStorage"||t=="openDatabase")e+=e?" "+t:t;return e},javascript_accepts_trailing_comma:!1};return e}();(function(e){function a(e){var t=e;return[t[1]||"",t[2]||"",t[3]||""].join(".")+(t[4]||"")+(t[5]||"")}function f(t){return t=e.parse(t),t?a(t):t}function l(t){return typeof t!="string"?null:e.parse(t)&&t.trim().replace(/^[v=]+/,"")}function c(e){return typeof e!="string"?null:e.match(u.parsePackage)&&e.trim()}function m(t){var n=(t||"").trim().replace(u.parseRange,e.rangeReplace).replace(d,v).split(/\s+/).join(" ").split("||").map(function(e){return e.replace(new RegExp("("+s+")\\s+"),"$1").split(" ").map(y).map(w).map(g).join(" ").trim()}).map(function(e){return e.trim().split(/\s+/).filter(function(e){return e.match(u.validComparator)})}).filter(function(e){return e.length});return n}function g(e){return e.trim().replace(h,p)}function y(e){return e.split(/\s+/).map(b).join(" ")}function b(e){return e.trim().replace(u.parseXRange,function(e,t,n,r,i,s){var o=!n||n.toLowerCase()==="x"||n==="*"||!r||r.toLowerCase()==="x"||r==="*"||!i||i.toLowerCase()==="x"||i==="*",u=e;if(t&&o)(!n||n==="*"||n.toLowerCase()==="x")&&(n=0),(!r||r==="*"||r.toLowerCase()==="x")&&(r=0),(!i||i==="*"||i.toLowerCase()==="x")&&(i=0),u=t+n+"."+r+"."+i+"-";else if(!n||n==="*"||n.toLowerCase()==="x")u="*";else if(!r||r==="*"||r.toLowerCase()==="x")u=">="+n+".0.0- <"+(+n+1)+".0.0-";else if(!i||i==="*"||i.toLowerCase()==="x")u=">="+n+"."+r+".0- <"+n+"."+(+r+1)+".0-";return u})}function w(e){return e.trim().replace(u.parseSpermy,function(e,t,n,r,i,s){if(t)throw new Error("Using '"+t+"' with ~ makes no sense. Don't do it.");return!n||n.toLowerCase()==="x"?"":!r||r.toLowerCase()==="x"?">="+n+".0.0- <"+(+n+1)+".0.0-":!i||i.toLowerCase()==="x"?">="+n+"."+r+".0- <"+n+"."+(+r+1)+".0-":(s=s||"-",">="+n+"."+r+"."+i+s+" <"+n+"."+(+r+1)+".0-")})}function E(e){e=g(e);var t=m(e);return t.length===0?null:t.map(function(e){return e.join(" ")}).join("||")}function S(e,t){return e.filter(function(e){return x(e,t)}).sort(T).pop()}function x(e,t){e=l(e);if(!e)return!1;t=m(t);for(var n=0,r=t.length;n<r;n++){var i=!1;for(var s=0,o=t[n].length;s<o;s++){var u=t[n][s],a=u.charAt(0)===">"?D:u.charAt(0)==="<"?C:!1,f=u.charAt(!!a)==="=",c=!!f+!!a;a||(f=!0),u=u.substr(c),u=u===""?u:l(u),i=u===""||f&&u===e||a&&a(e,u);if(!i)break}if(i)return!0}return!1}function T(e,t){var n=D(e,t);return n===null?0:n?1:-1}function N(e,t){return T(t,e)}function C(e,t){return D(t,e)}function k(e,t){return!C(e,t)}function L(e,t){return!D(e,t)}function A(e,t){return D(e,t)===null}function O(e,t){return D(e,t)!==null}function M(e,t,n){switch(t){case">":return D(e,n);case"<":return C(e,n);case">=":return k(e,n);case"<=":return L(e,n);case"==":return A(e,n);case"!=":return O(e,n);case"===":return e===n;case"!==":return e!==n;default:throw new Error("Y U NO USE VALID COMPARATOR!? "+t)}}function _(e){return e===undefined?-1:parseInt((e||"0").replace(/[^0-9]+/g,""),10)}function D(t,n){t=e.parse(t),n=e.parse(n);if(!t||!n)return!1;for(var r=1;r<5;r++){t[r]=_(t[r]),n[r]=_(n[r]);if(t[r]>n[r])return!0;if(t[r]!==n[r])return!1}var i=t[5]||"",s=n[5]||"";return i===s?null:i?s?i>s:!1:!0}function P(t,n){t=e.parse(t);if(!t)return null;var r={major:1,minor:2,patch:3,build:4},i=r[n];if(i===undefined)return null;var s=_(t[i]);t[i]=s===-1?1:s+1;for(var o=i+1;o<5;o++)_(t[o])!==-1&&(t[o]="0");return t[4]&&(t[4]="-"+t[4]),t[5]="",a(t)}var t="\\s*[v=]*\\s*([0-9]+)\\.([0-9]+)\\.([0-9]+)(-[0-9]+-?)?([a-zA-Z-+][a-zA-Z0-9-.:]*)?",n="^((<|>)?=?)s*("+t+")$|^$",r="[v=]*([0-9]+|x|X|\\*)(?:\\.([0-9]+|x|X|\\*)(?:\\.([0-9]+|x|X|\\*)([a-zA-Z-][a-zA-Z0-9-.:]*)?)?)?",i="((?:<|>)=?)?\\s*"+r,s="(?:~>?)",o=s+i,u=e.expressions={parse:new RegExp("^\\s*"+t+"\\s*$"),parsePackage:new RegExp("^\\s*([^/]+)[-@]("+t+")\\s*$"),parseRange:new RegExp("^\\s*("+t+")\\s+-\\s+("+t+")\\s*$"),validComparator:new RegExp("^"+n+"$"),parseXRange:new RegExp("^"+i+"$"),parseSpermy:new RegExp("^"+o+"$")};Object.getOwnPropertyNames(u).forEach(function(t){e[t]=function(e){return(""+(e||"")).match(u[t])}}),e.rangeReplace=">=$1 <=$7",e.clean=f,e.compare=T,e.rcompare=N,e.satisfies=x,e.gt=D,e.gte=k,e.lt=C,e.lte=L,e.eq=A,e.neq=O,e.cmp=M,e.inc=P,e.valid=l,e.validPackage=c,e.validRange=E,e.maxSatisfying=S,e.replaceStars=g,e.toComparators=m;var h=/(<|>)?=?\s*\*/g,p="",d=new RegExp("((<|>)?=|<|>)\\s*("+t+"|"+r+")","g"),v="$1$3"})(typeof exports=="object"?exports:semver={}),window.rangy=function(){function e(e,t){var n=typeof e[t];return n=="function"||n=="object"&&!!e[t]||n=="unknown"}function t(e,t){return typeof e[t]=="object"&&!!e[t]}function n(e,t){return typeof e[t]!="undefined"}function r(e){return function(t,n){for(var r=n.length;r--;)if(!e(t,n[r]))return!1;return!0}}function i(e){return e&&h(e,c)&&d(e,l)}function s(e){window.alert("Rangy not supported in your browser. Reason: "+e),v.initialized=!0,v.supported=!1}function o(){if(!v.initialized){var n,r=!1,o=!1;e(document,"createRange")&&(n=document.createRange(),h(n,f)&&d(n,a)&&(r=!0),n.detach()),(n=t(document,"body")?document.body:document.getElementsByTagName("body")[0])&&e(n,"createTextRange")&&(n=n.createTextRange(),i(n)&&(o=!0)),!r&&!o&&s("Neither Range nor TextRange are implemented"),v.initialized=!0,v.features={implementsDomRange:r,implementsTextRange:o},r=g.concat(m),o=0;for(n=r.length;o<n;++o)try{r[o](v)}catch(u){t(window,"console")&&e(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",u)}}}function u(e){this.name=e,this.supported=this.initialized=!1}var a=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],f=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],l=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],c=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"],h=r(e),p=r(t),d=r(n),v={version:"1.2.3",initialized:!1,supported:!0,util:{isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:h,areHostObjects:p,areHostProperties:d,isTextRange:i},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};v.fail=s,v.warn=function(e){e="Rangy warning: "+e,v.config.alertOnWarn?window.alert(e):typeof window.console!="undefined"&&typeof window.console.log!="undefined"&&window.console.log(e)},{}.hasOwnProperty?v.util.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}:s("hasOwnProperty not supported");var m=[],g=[];v.init=o,v.addInitListener=function(e){v.initialized?e(v):m.push(e)};var y=[];v.addCreateMissingNativeApiListener=function(e){y.push(e)},v.createMissingNativeApi=function(e){e=e||window,o();for(var t=0,n=y.length;t<n;++t)y[t](e)},u.prototype.fail=function(e){throw this.initialized=!0,this.supported=!1,Error("Module '"+this.name+"' failed to load: "+e)},u.prototype.warn=function(e){v.warn("Module "+this.name+": "+e)},u.prototype.createError=function(e){return Error("Error in Rangy "+this.name+" module: "+e)},v.createModule=function(e,t){var n=new u(e);v.modules[e]=n,g.push(function(e){t(e,n),n.initialized=!0,n.supported=!0})},v.requireModules=function(e){for(var t=0,n=e.length,r,i;t<n;++t){i=e[t],r=v.modules[i];if(!r||!(r instanceof u))throw Error("Module '"+i+"' not found");if(!r.supported)throw Error("Module '"+i+"' not supported")}};var b=!1;p=function(){b||(b=!0,v.initialized||o())};if(typeof window=="undefined")s("No window found");else{if(typeof document!="undefined")return e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",p,!1),e(window,"addEventListener")?window.addEventListener("load",p,!1):e(window,"attachEvent")?window.attachEvent("onload",p):s("Window does not have required addEventListener or attachEvent method"),v;s("No document found")}}(),rangy.createModule("DomUtil",function(e,t){function n(e){for(var t=0;e=e.previousSibling;)t++;return t}function r(e,t){var n=[],r;for(r=e;r;r=r.parentNode)n.push(r);for(r=t;r;r=r.parentNode)if(d(n,r))return r;return null}function i(e,t,n){for(n=n?e:e.parentNode;n;){e=n.parentNode;if(e===t)return n;n=e}return null}function s(e){return e=e.nodeType,e==3||e==4||e==8}function o(e,t){var n=t.nextSibling,r=t.parentNode;return n?r.insertBefore(e,n):r.appendChild(e),e}function u(e){if(e.nodeType==9)return e;if(typeof e.ownerDocument!="undefined")return e.ownerDocument;if(typeof e.document!="undefined")return e.document;if(e.parentNode)return u(e.parentNode);throw Error("getDocument: no document found for node")}function a(e){return e?s(e)?'"'+e.data+'"':e.nodeType==1?"<"+e.nodeName+(e.id?' id="'+e.id+'"':"")+">["+e.childNodes.length+"]":e.nodeName:"[No node]"}function f(e){this._next=this.root=e}function l(e,t){this.node=e,this.offset=t}function c(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var h=e.util;h.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),h.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var p=document.createElement("div");h.areHostMethods(p,["insertBefore","appendChild","cloneNode"])||t.fail("Incomplete Element implementation"),h.isHostProperty(p,"innerHTML")||t.fail("Element is missing innerHTML property"),p=document.createTextNode("test"),h.areHostMethods(p,["splitText","deleteData","insertData","appendData","cloneNode"])||t.fail("Incomplete Text Node implementation");var d=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1};f.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next,t;if(this._current)if(t=e.firstChild)this._next=t;else{for(t=null;e!==this.root&&!(t=e.nextSibling);)e=e.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},l.prototype={equals:function(e){return this.node===e.node&this.offset==e.offset},inspect:function(){return"[DomPosition("+a(this.node)+":"+this.offset+")]"}},c.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},c.prototype.toString=function(){return this.message},e.dom={arrayContains:d,isHtmlNamespace:function(e){var t;return typeof e.namespaceURI=="undefined"||(t=e.namespaceURI)===null||t=="http://www.w3.org/1999/xhtml"},parentElement:function(e){return e=e.parentNode,e.nodeType==1?e:null},getNodeIndex:n,getNodeLength:function(e){var t;return s(e)?e.length:(t=e.childNodes)?t.length:0},getCommonAncestor:r,isAncestorOf:function(e,t,n){for(t=n?t:t.parentNode;t;){if(t===e)return!0;t=t.parentNode}return!1},getClosestAncestorIn:i,isCharacterDataNode:s,insertAfter:o,splitDataNode:function(e,t){var n=e.cloneNode(!1);return n.deleteData(0,t),e.deleteData(t,e.length-t),o(n,e),n},getDocument:u,getWindow:function(e){e=u(e);if(typeof e.defaultView!="undefined")return e.defaultView;if(typeof e.parentWindow!="undefined")return e.parentWindow;throw Error("Cannot get a window object for node")},getIframeWindow:function(e){if(typeof e.contentWindow!="undefined")return e.contentWindow;if(typeof e.contentDocument!="undefined")return e.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element")},getIframeDocument:function(e){if(typeof e.contentDocument!="undefined")return e.contentDocument;if(typeof e.contentWindow!="undefined")return e.contentWindow.document;throw Error("getIframeWindow: No Document object found for iframe element")},getBody:function(e){return h.isHostObject(e,"body")?e.body:e.getElementsByTagName("body")[0]},getRootContainer:function(e){for(var t;t=e.parentNode;)e=t;return e},comparePoints:function(e,t,s,o){var u;if(e==s)return t===o?0:t<o?-1:1;if(u=i(s,e,!0))return t<=n(u)?-1:1;if(u=i(e,s,!0))return n(u)<o?-1:1;t=r(e,s),e=e===t?t:i(e,t,!0),s=s===t?t:i(s,t,!0);if(e===s)throw Error("comparePoints got to case 4 and childA and childB are the same!");for(t=t.firstChild;t;){if(t===e)return-1;if(t===s)return 1;t=t.nextSibling}throw Error("Should not be here!")},inspectNode:a,fragmentFromNodeChildren:function(e){for(var t=u(e).createDocumentFragment(),n;n=e.firstChild;)t.appendChild(n);return t},createIterator:function(e){return new f(e)},DomPosition:l},e.DOMException=c}),rangy.createModule("DomRange",function(e){function t(e,t){return e.nodeType!=3&&(P.isAncestorOf(e,t.startContainer,!0)||P.isAncestorOf(e,t.endContainer,!0))}function n(e){return P.getDocument(e.startContainer)}function r(e,t,n){if(t=e._listeners[t])for(var r=0,i=t.length;r<i;++r)t[r].call(e,{target:e,args:n})}function i(e){return new H(e.parentNode,P.getNodeIndex(e))}function s(e){return new H(e.parentNode,P.getNodeIndex(e)+1)}function o(e,t,n){var r=e.nodeType==11?e.firstChild:e;return P.isCharacterDataNode(t)?n==t.length?P.insertAfter(e,t):t.parentNode.insertBefore(e,n==0?t:P.splitDataNode(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),r}function u(e){for(var t,r,i=n(e.range).createDocumentFragment();r=e.next();){t=e.isPartiallySelectedSubtree(),r=r.cloneNode(!t),t&&(t=e.getSubtreeIterator(),r.appendChild(u(t)),t.detach(!0));if(r.nodeType==10)throw new B("HIERARCHY_REQUEST_ERR");i.appendChild(r)}return i}function a(e,t,n){var r,i;for(n=n||{stop:!1};r=e.next();)if(e.isPartiallySelectedSubtree()){if(t(r)===!1){n.stop=!0;return}r=e.getSubtreeIterator(),a(r,t,n),r.detach(!0);if(n.stop)return}else for(r=P.createIterator(r);i=r.next();)if(t(i)===!1){n.stop=!0;return}}function f(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),f(t),t.detach(!0)):e.remove()}function l(e){for(var t,r=n(e.range).createDocumentFragment(),i;t=e.next();){e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),i=e.getSubtreeIterator(),t.appendChild(l(i)),i.detach(!0)):e.remove();if(t.nodeType==10)throw new B("HIERARCHY_REQUEST_ERR");r.appendChild(t)}return r}function c(e,t,n){var r=!!t&&!!t.length,i,s=!!n;r&&(i=RegExp("^("+t.join("|")+")$"));var o=[];return a(new p(e,!1),function(e){(!r||i.test(e.nodeType))&&(!s||n(e))&&o.push(e)}),o}function h(e){return"["+(typeof e.getName=="undefined"?"Range":e.getName())+"("+P.inspectNode(e.startContainer)+":"+e.startOffset+", "+P.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function p(e,t){this.range=e,this.clonePartiallySelectedTextNodes=t;if(!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&P.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===n&&!P.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:P.getClosestAncestorIn(this.sc,n,!0),this._last=this.ec===n&&!P.isCharacterDataNode(this.ec)?this.ec.childNodes[this.eo-1]:P.getClosestAncestorIn(this.ec,n,!0))}}function d(e){this.code=this[e],this.codeName=e,this.message="RangeException: "+this.codeName}function v(e,t,n){this.nodes=c(e,t,n),this._next=this.nodes[0],this._position=0}function m(e){return function(t,n){for(var r,i=n?t:t.parentNode;i;){r=i.nodeType;if(P.arrayContains(e,r))return i;i=i.parentNode}return null}}function g(e,t){if(W(e,t))throw new d("INVALID_NODE_TYPE_ERR")}function y(e){if(!e.startContainer)throw new B("INVALID_STATE_ERR")}function b(e,t){if(!P.arrayContains(t,e.nodeType))throw new d("INVALID_NODE_TYPE_ERR")}function w(e,t){if(t<0||t>(P.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new B("INDEX_SIZE_ERR")}function E(e,t){if(U(e,!0)!==U(t,!0))throw new B("WRONG_DOCUMENT_ERR")}function S(e){if(z(e,!0))throw new B("NO_MODIFICATION_ALLOWED_ERR")}function x(e,t){if(!e)throw new B(t)}function T(e){return!!e.startContainer&&!!e.endContainer&&(!!P.arrayContains(F,e.startContainer.nodeType)||!!U(e.startContainer,!0))&&(!!P.arrayContains(F,e.endContainer.nodeType)||!!U(e.endContainer,!0))&&e.startOffset<=(P.isCharacterDataNode(e.startContainer)?e.startContainer.length:e.startContainer.childNodes.length)&&e.endOffset<=(P.isCharacterDataNode(e.endContainer)?e.endContainer.length:e.endContainer.childNodes.length)}function N(e){y(e);if(!T(e))throw Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function C(){}function k(e){e.START_TO_START=K,e.START_TO_END=Q,e.END_TO_END=G,e.END_TO_START=Y,e.NODE_BEFORE=Z,e.NODE_AFTER=et,e.NODE_BEFORE_AND_AFTER=tt,e.NODE_INSIDE=nt}function L(e){k(e),k(e.prototype)}function A(e,t){return function(){N(this);var n=this.startContainer,r=this.startOffset,i=this.commonAncestorContainer,o=new p(this,!0);return n!==i&&(n=P.getClosestAncestorIn(n,i,!0),r=s(n),n=r.node,r=r.offset),a(o,S),o.reset(),i=e(o),o.detach(),t(this,n,r,n,r),i}}function O(n,r,o){function u(e,t){return function(n){y(this),b(n,j),b(R(n),F),n=(e?i:s)(n),(t?a:c)(this,n.node,n.offset)}}function a(e,t,n){var i=e.endContainer,s=e.endOffset;if(t!==e.startContainer||n!==e.startOffset){if(R(t)!=R(i)||P.comparePoints(t,n,i,s)==1)i=t,s=n;r(e,t,n,i,s)}}function c(e,t,n){var i=e.startContainer,s=e.startOffset;if(t!==e.endContainer||n!==e.endOffset){if(R(t)!=R(i)||P.comparePoints(t,n,i,s)==-1)i=t,s=n;r(e,i,s,t,n)}}n.prototype=new C,e.util.extend(n.prototype,{setStart:function(e,t){y(this),g(e,!0),w(e,t),a(this,e,t)},setEnd:function(e,t){y(this),g(e,!0),w(e,t),c(this,e,t)},setStartBefore:u(!0,!0),setStartAfter:u(!1,!0),setEndBefore:u(!0,!1),setEndAfter:u(!1,!1),collapse:function(e){N(this),e?r(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):r(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){y(this),g(e,!0),r(this,e,0,e,P.getNodeLength(e))},selectNode:function(e){y(this),g(e,!1),b(e,j);var t=i(e);e=s(e),r(this,t.node,t.offset,e.node,e.offset)},extractContents:A(l,r),deleteContents:A(f,r),canSurroundContents:function(){N(this),S(this.startContainer),S(this.endContainer);var e=new p(this,!0),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);return e.detach(),!n},detach:function(){o(this)},splitBoundaries:function(){N(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,s=e===n;P.isCharacterDataNode(n)&&i>0&&i<n.length&&P.splitDataNode(n,i),P.isCharacterDataNode(e)&&t>0&&t<e.length&&(e=P.splitDataNode(e,t),s?(i-=t,n=e):n==e.parentNode&&i>=P.getNodeIndex(e)&&i++,t=0),r(this,e,t,n,i)},normalizeBoundaries:function(){N(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,i=this.endOffset,s=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(n=e,i=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},o=function(r){var s=r.previousSibling;if(s&&s.nodeType==r.nodeType){e=r;var o=r.length;t=s.length,r.insertData(0,s.data),s.parentNode.removeChild(s),e==n?(i+=t,n=e):n==r.parentNode&&(s=P.getNodeIndex(r),i==s?(n=r,i=o):i>s&&i--)}},u=!0;P.isCharacterDataNode(n)?n.length==i&&s(n):(i>0&&(u=n.childNodes[i-1])&&P.isCharacterDataNode(u)&&s(u),u=!this.collapsed),u?P.isCharacterDataNode(e)?t==0&&o(e):t<e.childNodes.length&&(s=e.childNodes[t])&&P.isCharacterDataNode(s)&&o(s):(e=n,t=i),r(this,e,t,n,i)},collapseToPoint:function(e,t){y(this),g(e,!0),w(e,t),(e!==this.startContainer||t!==this.startOffset||e!==this.endContainer||t!==this.endOffset)&&r(this,e,t,e,t)}}),L(n)}function M(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:P.getCommonAncestor(e.startContainer,e.endContainer)}function _(e,t,n,i,s){var o=e.startContainer!==t||e.startOffset!==n,u=e.endContainer!==i||e.endOffset!==s;e.startContainer=t,e.startOffset=n,e.endContainer=i,e.endOffset=s,M(e),r(e,"boundarychange",{startMoved:o,endMoved:u})}function D(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},M(this)}e.requireModules(["DomUtil"]);var P=e.dom,H=P.DomPosition,B=e.DOMException;p.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,P.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e=this._current,t,n;!P.isCharacterDataNode(e)||e!==this.sc&&e!==this.ec?e.parentNode&&e.parentNode.removeChild(e):(t=e===this.sc?this.so:0,n=e===this.ec?this.eo:e.length,t!=n&&e.deleteData(t,n-t))},isPartiallySelectedSubtree:function(){return t(this._current,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse();else{e=new D(n(this.range));var t=this._current,r=t,i=0,s=t,o=P.getNodeLength(t);P.isAncestorOf(t,this.sc,!0)&&(r=this.sc,i=this.so),P.isAncestorOf(t,this.ec,!0)&&(s=this.ec,o=this.eo),_(e,r,i,s,o)}return new p(e,this.clonePartiallySelectedTextNodes)},detach:function(e){e&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},d.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},d.prototype.toString=function(){return this.message},v.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var j=[1,3,4,5,7,8,10],F=[2,9,11],I=[1,3,4,5,7,8,10,11],q=[1,3,4,5,7,8],R=P.getRootContainer,U=m([9,11]),z=m([5,6,10,12]),W=m([6,10,12]),X=document.createElement("style"),V=!1;try{X.innerHTML="<b>x</b>",V=X.firstChild.nodeType==3}catch($){}e.features.htmlParsingConforms=V;var J=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],K=0,Q=1,G=2,Y=3,Z=0,et=1,tt=2,nt=3;C.prototype={attachListener:function(e,t){this._listeners[e].push(t)},compareBoundaryPoints:function(e,t){N(this),E(this.startContainer,t.startContainer);var n=e==Y||e==K?"start":"end",r=e==Q||e==K?"start":"end";return P.comparePoints(this[n+"Container"],this[n+"Offset"],t[r+"Container"],t[r+"Offset"])},insertNode:function(e){N(this),b(e,I),S(this.startContainer);if(P.isAncestorOf(e,this.startContainer,!0))throw new B("HIERARCHY_REQUEST_ERR");this.setStartBefore(o(e,this.startContainer,this.startOffset))},cloneContents:function(){N(this);var e,t;return this.collapsed?n(this).createDocumentFragment():this.startContainer===this.endContainer&&P.isCharacterDataNode(this.startContainer)?(e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=n(this).createDocumentFragment(),t.appendChild(e),t):(t=new p(this,!0),e=u(t),t.detach(),e)},canSurroundContents:function(){N(this),S(this.startContainer),S(this.endContainer);var e=new p(this,!0),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);return e.detach(),!n},surroundContents:function(e){b(e,q);if(!this.canSurroundContents())throw new d("BAD_BOUNDARYPOINTS_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);o(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){N(this);for(var e=new D(n(this)),t=J.length,r;t--;)r=J[t],e[r]=this[r];return e},toString:function(){N(this);var e=this.startContainer;if(e===this.endContainer&&P.isCharacterDataNode(e))return e.nodeType==3||e.nodeType==4?e.data.slice(this.startOffset,this.endOffset):"";var t=[];return e=new p(this,!0),a(e,function(e){(e.nodeType==3||e.nodeType==4)&&t.push(e.data)}),e.detach(),t.join("")},compareNode:function(e){N(this);var t=e.parentNode,n=P.getNodeIndex(e);if(!t)throw new B("NOT_FOUND_ERR");return e=this.comparePoint(t,n),t=this.comparePoint(t,n+1),e<0?t>0?tt:Z:t>0?et:nt},comparePoint:function(e,t){return N(this),x(e,"HIERARCHY_REQUEST_ERR"),E(e,this.startContainer),P.comparePoints(e,t,this.startContainer,this.startOffset)<0?-1:P.comparePoints(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:V?function(e){var t=this.startContainer,n=P.getDocument(t);if(!t)throw new B("INVALID_STATE_ERR");var r=null;return t.nodeType==1?r=t:P.isCharacterDataNode(t)&&(r=P.parentElement(t)),r=r===null||r.nodeName=="HTML"&&P.isHtmlNamespace(P.getDocument(r).documentElement)&&P.isHtmlNamespace(r)?n.createElement("body"):r.cloneNode(!1),r.innerHTML=e,P.fragmentFromNodeChildren(r)}:function(e){y(this);var t=n(this).createElement("body");return t.innerHTML=e,P.fragmentFromNodeChildren(t)},toHtml:function(){N(this);var e=n(this).createElement("div");return e.appendChild(this.cloneContents()),e.innerHTML},intersectsNode:function(e,t){N(this),x(e,"NOT_FOUND_ERR");if(P.getDocument(e)!==n(this))return!1;var r=e.parentNode,i=P.getNodeIndex(e);x(r,"NOT_FOUND_ERR");var s=P.comparePoints(r,i,this.endContainer,this.endOffset);return r=P.comparePoints(r,i+1,this.startContainer,this.startOffset),t?s<=0&&r>=0:s<0&&r>0},isPointInRange:function(e,t){return N(this),x(e,"HIERARCHY_REQUEST_ERR"),E(e,this.startContainer),P.comparePoints(e,t,this.startContainer,this.startOffset)>=0&&P.comparePoints(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e,t){N(this);if(n(e)!=n(this))throw new B("WRONG_DOCUMENT_ERR");var r=P.comparePoints(this.startContainer,this.startOffset,e.endContainer,e.endOffset),i=P.comparePoints(this.endContainer,this.endOffset,e.startContainer,e.startOffset);return t?r<=0&&i>=0:r<0&&i>0},intersection:function(e){if(this.intersectsRange(e)){var t=P.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=P.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset),r=this.cloneRange();return t==-1&&r.setStart(e.startContainer,e.startOffset),n==1&&r.setEnd(e.endContainer,e.endOffset),r}return null},union:function(e){if(this.intersectsRange(e,!0)){var t=this.cloneRange();return P.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1&&t.setStart(e.startContainer,e.startOffset),P.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)==1&&t.setEnd(e.endContainer,e.endOffset),t}throw new d("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==nt},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,P.getNodeLength(e))<=0},containsRange:function(e){return this.intersection(e).equals(e)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);return n.length>0?(t.setStart(n[0],0),e=n.pop(),t.setEnd(e,e.length),e=this.containsRange(t),t.detach(),e):this.containsNodeContents(e)},createNodeIterator:function(e,t){return N(this),new v(this,e,t)},getNodes:function(e,t){return N(this),c(this,e,t)},getDocument:function(){return n(this)},collapseBefore:function(e){y(this),this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){y(this),this.setStartAfter(e),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(e){return D.rangesEqual(this,e)},isValid:function(){return T(this)},inspect:function(){return h(this)}},O(D,_,function(e){y(e),e.startContainer=e.startOffset=e.endContainer=e.endOffset=null,e.collapsed=e.commonAncestorContainer=null,r(e,"detach",null),e._listeners=null}),e.rangePrototype=C.prototype,D.rangeProperties=J,D.RangeIterator=p,D.copyComparisonConstants=L,D.createPrototypeRange=O,D.inspect=h,D.getRangeDocument=n,D.rangesEqual=function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},e.DomRange=D,e.RangeException=d}),rangy.createModule("WrappedRange",function(e){function t(e,t,n,r){var o=e.duplicate();o.collapse(n);var u=o.parentElement();i.isAncestorOf(t,u,!0)||(u=t);if(!u.canHaveHTML)return new s(u.parentNode,i.getNodeIndex(u));t=i.getDocument(u).createElement("span");var a,f=n?"StartToStart":"StartToEnd";do u.insertBefore(t,t.previousSibling),o.moveToElementText(t);while((a=o.compareEndPoints(f,e))>0&&t.previousSibling);f=t.nextSibling;if(a==-1&&f&&i.isCharacterDataNode(f)){o.setEndPoint(n?"EndToStart":"EndToEnd",e);if(/[\r\n]/.test(f.data)){u=o.duplicate(),n=u.text.replace(/\r\n/g,"\r").length;for(n=u.moveStart("character",n);u.compareEndPoints("StartToEnd",u)==-1;)n++,u.moveStart("character",1)}else n=o.text.length;u=new s(f,n)}else f=(r||!n)&&t.previousSibling,u=(n=(r||n)&&t.nextSibling)&&i.isCharacterDataNode(n)?new s(n,0):f&&i.isCharacterDataNode(f)?new s(f,f.length):new s(u,i.getNodeIndex(t));return t.parentNode.removeChild(t),u}function n(e,t){var n,r,s=e.offset,o=i.getDocument(e.node),u=o.body.createTextRange(),a=i.isCharacterDataNode(e.node);return a?(n=e.node,r=n.parentNode):(n=e.node.childNodes,n=s<n.length?n[s]:null,r=e.node),o=o.createElement("span"),o.innerHTML="&#feff;",n?r.insertBefore(o,n):r.appendChild(o),u.moveToElementText(o),u.collapse(!t),r.removeChild(o),a&&u[t?"moveStart":"moveEnd"]("character",s),u}e.requireModules(["DomUtil","DomRange"]);var r,i=e.dom,s=i.DomPosition,o=e.DomRange;if(e.features.implementsDomRange&&(!e.features.implementsTextRange||!e.config.preferTextRange))(function(){function t(e){for(var t=s.length,n;t--;)n=s[t],e[n]=e.nativeRange[n]}var n,s=o.rangeProperties,u,a;r=function(e){if(!e)throw Error("Range must be specified");this.nativeRange=e,t(this)},o.createPrototypeRange(r,function(e,t,n,r,i){var s=e.endContainer!==r||e.endOffset!=i;if(e.startContainer!==t||e.startOffset!=n||s)e.setEnd(r,i),e.setStart(t,n)},function(e){e.nativeRange.detach(),e.detached=!0;for(var t=s.length,n;t--;)n=s[t],e[n]=null}),n=r.prototype,n.selectNode=function(e){this.nativeRange.selectNode(e),t(this)},n.deleteContents=function(){this.nativeRange.deleteContents(),t(this)},n.extractContents=function(){var e=this.nativeRange.extractContents();return t(this),e},n.cloneContents=function(){return this.nativeRange.cloneContents()},n.surroundContents=function(e){this.nativeRange.surroundContents(e),t(this)},n.collapse=function(e){this.nativeRange.collapse(e),t(this)},n.cloneRange=function(){return new r(this.nativeRange.cloneRange())},n.refresh=function(){t(this)},n.toString=function(){return this.nativeRange.toString()};var f=document.createTextNode("test");i.getBody(document).appendChild(f);var c=document.createRange();c.setStart(f,0),c.setEnd(f,0);try{c.setStart(f,1),u=!0,n.setStart=function(e,n){this.nativeRange.setStart(e,n),t(this)},n.setEnd=function(e,n){this.nativeRange.setEnd(e,n),t(this)},a=function(e){return function(n){this.nativeRange[e](n),t(this)}}}catch(h){u=!1,n.setStart=function(e,n){try{this.nativeRange.setStart(e,n)}catch(r){this.nativeRange.setEnd(e,n),this.nativeRange.setStart(e,n)}t(this)},n.setEnd=function(e,n){try{this.nativeRange.setEnd(e,n)}catch(r){this.nativeRange.setStart(e,n),this.nativeRange.setEnd(e,n)}t(this)},a=function(e,n){return function(r){try{this.nativeRange[e](r)}catch(i){this.nativeRange[n](r),this.nativeRange[e](r)}t(this)}}}n.setStartBefore=a("setStartBefore","setEndBefore"),n.setStartAfter=a("setStartAfter","setEndAfter"),n.setEndBefore=a("setEndBefore","setStartBefore"),n.setEndAfter=a("setEndAfter","setStartAfter"),c.selectNodeContents(f),n.selectNodeContents=c.startContainer==f&&c.endContainer==f&&c.startOffset==0&&c.endOffset==f.length?function(e){this.nativeRange.selectNodeContents(e),t(this)}:function(e){this.setStart(e,0),this.setEnd(e,o.getEndOffset(e))},c.selectNodeContents(f),c.setEnd(f,3),u=document.createRange(),u.selectNodeContents(f),u.setEnd(f,4),u.setStart(f,2),n.compareBoundaryPoints=c.compareBoundaryPoints(c.START_TO_END,u)==-1&c.compareBoundaryPoints(c.END_TO_START,u)==1?function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)},e.util.isHostMethod(c,"createContextualFragment")&&(n.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),i.getBody(document).removeChild(f),c.detach(),u.detach()})(),e.createNativeRange=function(e){return e=e||document,e.createRange()};else if(e.features.implementsTextRange){r=function(e){this.textRange=e,this.refresh()},r.prototype=new o(document),r.prototype.refresh=function(){var e,n,r=this.textRange;e=r.parentElement();var s=r.duplicate();s.collapse(!0),n=s.parentElement(),s=r.duplicate(),s.collapse(!1),r=s.parentElement(),n=n==r?n:i.getCommonAncestor(n,r),n=n==e?n:i.getCommonAncestor(e,n),this.textRange.compareEndPoints("StartToEnd",this.textRange)==0?n=e=t(this.textRange,n,!0,!0):(e=t(this.textRange,n,!0,!1),n=t(this.textRange,n,!1,!1)),this.setStart(e.node,e.offset),this.setEnd(n.node,n.offset)},o.copyComparisonConstants(r);var u=function(){return this}();typeof u.Range=="undefined"&&(u.Range=r),e.createNativeRange=function(e){return e=e||document,e.body.createTextRange()}}e.features.implementsTextRange&&(r.rangeToTextRange=function(e){if(e.collapsed)return n(new s(e.startContainer,e.startOffset),!0);var t=n(new s(e.startContainer,e.startOffset),!0),r=n(new s(e.endContainer,e.endOffset),!1);return e=i.getDocument(e.startContainer).body.createTextRange(),e.setEndPoint("StartToStart",t),e.setEndPoint("EndToEnd",r),e}),r.prototype.getName=function(){return"WrappedRange"},e.WrappedRange=r,e.createRange=function(t){return t=t||document,new r(e.createNativeRange(t))},e.createRangyRange=function(e){return e=e||document,new o(e)},e.createIframeRange=function(t){return e.createRange(i.getIframeDocument(t))},e.createIframeRangyRange=function(t){return e.createRangyRange(i.getIframeDocument(t))},e.addCreateMissingNativeApiListener(function(t){t=t.document,typeof t.createRange=="undefined"&&(t.createRange=function(){return e.createRange(this)}),t=t=null})}),rangy.createModule("WrappedSelection",function(e,t){function n(e){return(e||window).getSelection()}function r(e){return(e||window).document.selection}function i(e,t,n){var r=n?"end":"start";n=n?"start":"end",e.anchorNode=t[r+"Container"],e.anchorOffset=t[r+"Offset"],e.focusNode=t[n+"Container"],e.focusOffset=t[n+"Offset"]}function s(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function o(t){var n;return t instanceof g?(n=t._selectionNativeRange,n||(n=e.createNativeRange(v.getDocument(t.startContainer)),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset),t._selectionNativeRange=n,t.attachListener("detach",function(){this._selectionNativeRange=null}))):t instanceof y?n=t.nativeRange:e.features.implementsDomRange&&t instanceof v.getWindow(t.startContainer).Range&&(n=t),n}function u(e){var t=e.getNodes(),n;e:if(!t.length||t[0].nodeType!=1)n=!1;else{n=1;for(var r=t.length;n<r;++n)if(!v.isAncestorOf(t[0],t[n])){n=!1;break e}n=!0}if(!n)throw Error("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function a(e,t){var n=new y(t);e._ranges=[n],i(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function f(t){t._ranges.length=0;if(t.docSelection.type=="None")s(t);else{var n=t.docSelection.createRange();if(n&&typeof n.text!="undefined")a(t,n);else{t.rangeCount=n.length;for(var r,o=v.getDocument(n.item(0)),u=0;u<t.rangeCount;++u)r=e.createRange(o),r.selectNode(n.item(u)),t._ranges.push(r);t.isCollapsed=t.rangeCount==1&&t._ranges[0].collapsed,i(t,t._ranges[t.rangeCount-1],!1)}}}function l(e,t){var n=e.docSelection.createRange(),r=u(t),i=v.getDocument(n.item(0));i=v.getBody(i).createControlRange();for(var s=0,o=n.length;s<o;++s)i.add(n.item(s));try{i.add(r)}catch(a){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}i.select(),f(e)}function c(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function h(e,t){var n=v.getDocument(t[0].startContainer);n=v.getBody(n).createControlRange();for(var r=0,i;r<rangeCount;++r){i=u(t[r]);try{n.add(i)}catch(s){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}n.select(),f(e)}function p(e,t){if(e.anchorNode&&v.getDocument(e.anchorNode)!==v.getDocument(t))throw new b("WRONG_DOCUMENT_ERR")}function d(e){var t=[],n=new w(e.anchorNode,e.anchorOffset),r=new w(e.focusNode,e.focusOffset),i=typeof e.getName=="function"?e.getName():"Selection";if(typeof e.rangeCount!="undefined")for(var s=0,o=e.rangeCount;s<o;++s)t[s]=g.inspect(e.getRangeAt(s));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]),e.config.checkSelectionRanges=!0;var v=e.dom,m=e.util,g=e.DomRange,y=e.WrappedRange,b=e.DOMException,w=v.DomPosition,E,S,x=e.util.isHostMethod(window,"getSelection"),T=e.util.isHostObject(document,"selection"),N=T&&(!x||e.config.preferTextRange);N?(E=r,e.isSelectionValid=function(e){e=(e||window).document;var t=e.selection;return t.type!="None"||v.getDocument(t.createRange().parentElement())==e}):x?(E=n,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected."),e.getNativeSelection=E,x=E();var C=e.createNativeRange(document),k=v.getBody(document),L=m.areHostObjects(x,m.areHostProperties(x,["anchorOffset","focusOffset"]));e.features.selectionHasAnchorAndFocus=L;var A=m.isHostMethod(x,"extend");e.features.selectionHasExtend=A;var O=typeof x.rangeCount=="number";e.features.selectionHasRangeCount=O;var M=!1,_=!0;m.areHostMethods(x,["addRange","getRangeAt","removeAllRanges"])&&typeof x.rangeCount=="number"&&e.features.implementsDomRange&&function(){var e=document.createElement("iframe");e.frameBorder=0,e.style.position="absolute",e.style.left="-10000px",k.appendChild(e);var t=v.getIframeDocument(e);t.open(),t.write("<html><head></head><body>12</body></html>"),t.close();var n=v.getIframeWindow(e).getSelection(),r=t.documentElement.lastChild.firstChild;t=t.createRange(),t.setStart(r,1),t.collapse(!0),n.addRange(t),_=n.rangeCount==1,n.removeAllRanges();var i=t.cloneRange();t.setStart(r,0),i.setEnd(r,2),n.addRange(t),n.addRange(i),M=n.rangeCount==2,t.detach(),i.detach(),k.removeChild(e)}(),e.features.selectionSupportsMultipleRanges=M,e.features.collapsedNonEditableSelectionsSupported=_;var D=!1,P;k&&m.isHostMethod(k,"createControlRange")&&(P=k.createControlRange(),m.areHostProperties(P,["item","add"])&&(D=!0)),e.features.implementsControlRange=D,S=L?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var H;m.isHostMethod(x,"getRangeAt")?H=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:L&&(H=function(t){var n=v.getDocument(t.anchorNode);return n=e.createRange(n),n.setStart(t.anchorNode,t.anchorOffset),n.setEnd(t.focusNode,t.focusOffset),n.collapsed!==this.isCollapsed&&(n.setStart(t.focusNode,t.focusOffset),n.setEnd(t.anchorNode,t.anchorOffset)),n}),e.getSelection=function(e){e=e||window;var t=e._rangySelection,n=E(e),i=T?r(e):null;return t?(t.nativeSelection=n,t.docSelection=i,t.refresh(e)):(t=new c(n,i,e),e._rangySelection=t),t},e.getIframeSelection=function(t){return e.getSelection(v.getIframeWindow(t))},P=c.prototype;if(!N&&L&&m.areHostMethods(x,["removeAllRanges","addRange"])){P.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),s(this)};var B=function(t,n){var r=g.getRangeDocument(n);r=e.createRange(r),r.collapseToPoint(n.endContainer,n.endOffset),t.nativeSelection.addRange(o(r)),t.nativeSelection.extend(n.startContainer,n.startOffset),t.refresh()};P.addRange=O?function(t,n){if(D&&T&&this.docSelection.type=="Control")l(this,t);else if(n&&A)B(this,t);else{var r;M?r=this.rangeCount:(this.removeAllRanges(),r=0),this.nativeSelection.addRange(o(t)),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==r+1?(e.config.checkSelectionRanges&&(r=H(this.nativeSelection,this.rangeCount-1))&&!g.rangesEqual(r,t)&&(t=new y(r)),this._ranges[this.rangeCount-1]=t,i(this,t,I(this.nativeSelection)),this.isCollapsed=S(this)):this.refresh()}}:function(e,t){t&&A?B(this,e):(this.nativeSelection.addRange(o(e)),this.refresh())},P.setRanges=function(e){if(D&&e.length>1)h(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(m.isHostMethod(x,"empty")&&m.isHostMethod(C,"select")&&D&&N))return t.fail("No means of selecting a Range or TextRange was found"),!1;P.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var e;if(this.anchorNode)e=v.getDocument(this.anchorNode);else if(this.docSelection.type=="Control"){var t=this.docSelection.createRange();t.length&&(e=v.getDocument(t.item(0)).body.createTextRange())}e&&(e.body.createTextRange().select(),this.docSelection.empty())}}catch(n){}s(this)},P.addRange=function(e){this.docSelection.type=="Control"?l(this,e):(y.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,i(this,e,!1))},P.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?h(this,e):t&&this.addRange(e[0])}}P.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new b("INDEX_SIZE_ERR");return this._ranges[e]};var j;if(N)j=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=v.getBody(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type=="Control"?f(t):n&&typeof n.text!="undefined"?a(t,n):s(t)};else if(m.isHostMethod(x,"getRangeAt")&&typeof x.rangeCount=="number")j=function(t){if(D&&T&&t.docSelection.type=="Control")f(t);else{t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount;if(t.rangeCount){for(var n=0,r=t.rangeCount;n<r;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));i(t,t._ranges[t.rangeCount-1],I(t.nativeSelection)),t.isCollapsed=S(t)}else s(t)}};else{if(!L||typeof x.isCollapsed!="boolean"||typeof C.collapsed!="boolean"||!e.features.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;j=function(e){var t;t=e.nativeSelection,t.anchorNode?(t=H(t,0),e._ranges=[t],e.rangeCount=1,t=e.nativeSelection,e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset,e.isCollapsed=S(e)):s(e)}}P.refresh=function(e){var t=e?this._ranges.slice(0):null;j(this);if(e){e=t.length;if(e!=this._ranges.length)return!1;for(;e--;)if(!g.rangesEqual(t[e],this._ranges[e]))return!1;return!0}};var F=function(e,t){var n=e.getAllRanges(),r=!1;e.removeAllRanges();for(var i=0,o=n.length;i<o;++i)r||t!==n[i]?e.addRange(n[i]):r=!0;e.rangeCount||s(e)};P.removeRange=D?function(e){if(this.docSelection.type=="Control"){var t=this.docSelection.createRange();e=u(e);var n=v.getDocument(t.item(0));n=v.getBody(n).createControlRange();for(var r,i=!1,s=0,o=t.length;s<o;++s)r=t.item(s),r!==e||i?n.add(t.item(s)):i=!0;n.select(),f(this)}else F(this,e)}:function(e){F(this,e)};var I;!N&&L&&e.features.implementsDomRange?(I=function(e){var t=!1;return e.anchorNode&&(t=v.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1),t},P.isBackwards=function(){return I(this)}):I=P.isBackwards=function(){return!1},P.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},P.collapse=function(t,n){p(this,t);var r=e.createRange(v.getDocument(t));r.collapseToPoint(t,n),this.removeAllRanges(),this.addRange(r),this.isCollapsed=!0},P.collapseToStart=function(){if(!this.rangeCount)throw new b("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},P.collapseToEnd=function(){if(!this.rangeCount)throw new b("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},P.selectAllChildren=function(t){p(this,t);var n=e.createRange(v.getDocument(t));n.selectNodeContents(t),this.removeAllRanges(),this.addRange(n)},P.deleteFromDocument=function(){if(D&&T&&this.docSelection.type=="Control"){for(var e=this.docSelection.createRange(),t;e.length;)t=e.item(0),e.remove(t),t.parentNode.removeChild(t);this.refresh()}else if(this.rangeCount){e=this.getAllRanges(),this.removeAllRanges(),t=0;for(var n=e.length;t<n;++t)e[t].deleteContents();this.addRange(e[n-1])}},P.getAllRanges=function(){return this._ranges.slice(0)},P.setSingleRange=function(e){this.setRanges([e])},P.containsNode=function(e,t){for(var n=0,r=this._ranges.length;n<r;++n)if(this._ranges[n].containsNode(e,t))return!0;return!1},P.toHtml=function(){var e="";if(this.rangeCount){e=g.getRangeDocument(this._ranges[0]).createElement("div");for(var t=0,n=this._ranges.length;t<n;++t)e.appendChild(this._ranges[t].cloneContents());e=e.innerHTML}return e},P.getName=function(){return"WrappedSelection"},P.inspect=function(){return d(this)},P.detach=function(){this.win=this.anchorNode=this.focusNode=this.win._rangySelection=null},c.inspect=d,e.Selection=c,e.selectionPrototype=P,e.addCreateMissingNativeApiListener(function(t){typeof t.getSelection=="undefined"&&(t.getSelection=function(){return e.getSelection(this)}),t=null})});var __indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};jQuery(document).ready(function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d=this;return f=function(e){var t,n;return n=document.createElement("a"),n.href=e,t=n.hostname,t?t.split(".")[0]:!1},u=function(e){return e.length>0?e[0]:!1},o=function(e){var t;if(window.nds_opts.localization!=null){t=window.nds_opts.localization[e];if(t!=null&&t)return t}return e},p=o,t=window.NDS_API_HOST||t,window.NDS_SHORT_NAME=f(t),n="0.0.3",r={NotifyWindow:function(t){return e('<div class="modal hide fade" id="notifications">\n    <div class="modal-header">\n        <button\n            type="button"\n            class="close"\n            data-dismiss="modal"\n            aria-hidden="true">&times;</button>\n        <h3>Neahttadigisánit</h3>\n    </div>\n    <div class="modal-body">'+t+'</div>\n    <div class="modal-footer">\n        <a href="#" class="btn btn-primary" id="close_modal">\n          Continue\n        </a>\n    </div>\n</div>')},OptionsMenu:function(e){return"omg"},OptionsTab:function(n){var r,i;return i=function(e){var t,n,r,i,s,o;i=[];for(r=s=0,o=e.length;s<o;r=++s)n=e[r],r+1===1?t="checked":t="",i.push('<option value="'+n.from.iso+"-"+n.to.iso+'">\n'+n.from.name+" → "+n.to.name+"\n</option>");return i.join("\n")},r=e('<div id="webdict_options">\n  <div class="well">\n  <a class="close" href="#" style="display: none;">&times;</a>\n  <div class="trigger">\n    <h1><a href="#" class="open">'+p("Á")+'</a></h1>\n  </div>\n\n  <div class="option_panel" style="display: none;">\n    <ul class="nav nav-pills">\n      <li class="active">\n        <a href="#" data-target="#options">'+p("Options")+'</a>\n      </li>\n      <li><a href="#" data-target="#about">'+p("About")+'</a></li>\n      <li style="display: none;" id="debug"><a href="#" data-target="#advanced">'+p("Advanced")+'</a></li>\n    </ul>\n    <div id="options" class="minipanel">\n      <form class="">\n        <label class="control-label" for="inputEmail">'+p("Dictionary")+'</label>\n        <select type="radio"\n               name="language_pair">\n        '+i(n.dictionaries)+'\n        </select>\n        <br />\n        <button type="submit" class="btn" id="save">'+p("Save")+'</button>\n      </form>\n    </div>\n    <div id="advanced" style="display: none;" class="minipanel">\n      <br />\n      <strong>Advanced settings</strong>\n      <p>This deletes all stored settings, dictionary names, and translations of the application.</p>\n      <a href="#" type="submit" class="btn btn-small" id="refresh_settings">'+p("Refresh settings")+"</a>\n      <br />\n      <br />\n      <strong>Hostname:</strong>\n      <blockquote><pre>"+t+'</pre></blockquote>\n      <strong>Alerts:</strong>\n      <p>Display an alert for debugging.</p>\n      <a href="#" type="submit" class="btn btn-small" id="display_update_window">'+p("Update detected")+'</a>\n      <a href="#" type="submit" class="btn btn-small" id="display_ie8_warning_window">'+p("IE8 Warning")+'</a>\n      <br />\n      <br />\n    </div>\n    <div id="about" style="display: none;" class="minipanel">\n        <p>'+p("In order to look up a word, hold down the <em>Alt</em> or <em>Option</em> (⌥) key, and doubleclick on a word. The service will contact the dictionary, and return a word after a short pause.")+"</p>\n        <p> </p>\n        <p>"+p('If you find a bug, or if the bookmark does not work on a specific page <a href="mailto:giellatekno@hum.uit.no">please contact us</a>. Tell us what page didn\'t work, or what you did when you discovered the problem.')+"\n        </p>\n    </div>\n  </div>\n</div>"),r.find("ul.nav-pills a").click(function(t){var n;return n=e(t.target).attr("data-target"),r.find("ul.nav-pills a").parent("li").removeClass("active"),e(t.target).parent("li").addClass("active"),r.find("div.minipanel").hide(),r.find(n).show(),!1}),r.find(".trigger").click(function(){var e;return e=r.find("div.option_panel"),e.toggle(),r.find("a.close").toggle(),!1}),r.find("a.close").click(function(){var e;return e=r.find("div.option_panel"),e.toggle(),r.find("a.close").toggle(),!1}),r.find("button#save").click(function(){var e;return e=r.find("div.option_panel"),e.toggle(),r.find("a.close").toggle(),!1}),r.find("a#refresh_settings").click(function(){return DSt.set(NDS_SHORT_NAME+"-"+"digisanit-select-langpair",null),DSt.set(NDS_SHORT_NAME+"-"+"nds-languages",null),DSt.set(NDS_SHORT_NAME+"-"+"nds-localization",null),DSt.set(NDS_SHORT_NAME+"-"+"nds-stored-config",null),r.find("#advanced").append(e("<p />").html("Reload the plugin...")),!1}),r.find("a#display_update_window").click(function(){return window.newVersionNotify(),!1}),r.find("a#display_ie8_warning_window").click(function(){return window.ie8Notify(),!1}),r.find('select[name="language_pair"]').change(function(t){var n;return n=e(t.target).val(),DSt.set(NDS_SHORT_NAME+"-"+"digisanit-select-langpair",n),!0}),r.find("form").submit(function(){var e;return e=r.find("div.option_panel"),e.toggle(),r.find("a.close").toggle(),!1}),r},ErrorBar:function(t){var n,r;return r=t.host,n=e('<div id="nds_errors" class="errornav navbar-inverse navbar-fixed-bottom">\n  <div class="navbar-inner">\n    <div class="container">\n      <p><strong>'+p("Error!")+"</strong> "+p("Could not connect to dictionary server")+" (host: "+r+').\n         <a href="#" class="dismiss">'+p("Close")+"</a>.</p>\n    </div>\n  </div>\n</div>"),n.find("a.dismiss").click(function(){return e("body .errornav").remove(),!1}),n}},l=function(t){var n,r;return r=e(document).find(".spinner"),r.length===0?(n=e('<img src="'+t+'" class="spinner" />'),e(document).find("body").append(n),n):r},e.ajaxSetup({type:"GET",timeout:1e4,beforeSend:function(e){var t;return t=l(),t.show()},complete:function(e){var t;return t=l(),t.hide()},dataType:"json",cache:!0,error:function(){return e(document).find("body").find(".errornav").remove(),e(document).find("body").append(r.ErrorBar({host:t}))}}),a=function(){var e;return e=rangy.getSelection(),e.rangeCount?e.getRangeAt(0):null},s=function(e){return e.cloneContents().textContent},h=function(e,t){if(e){if(!e.canSurroundContents())return!1;try{return e.surroundContents(t)}catch(n){return(n instanceof rangy.RangeException||Object.prototype.toString.call(n)==="[object RangeException]")&&n.code===1?alert("Unable to surround range because range partially selects a\nnon-text node. See DOM Level 2 Range spec for more\ninformation.\n\n"+n):alert("Unexpected errror: "+n)}}},i=function(t,n,r){var i,s,o,a,f,l,c,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,D,P,H,B,j=this;b=t.string,o=t.element,d=t.range,r.tooltip&&(B=e('<a style="font-style: italic; border: 1px solid #CEE; padding: 0 2px" \n   class="tooltip_target">'+b+"</a>")[0],h(d,B)),g=[],L=n.result;for(S=0,N=L.length;S<N;S++){v=L[S],A=v.lookups;for(x=0,C=A.length;x<C;x++){l=A[x];if(l.right.length>1){i=[],O=l.right;for(a=T=0,k=O.length;T<k;a=++T)c=O[a],i.push(""+(a+1)+". "+c);y=i.join(", ")}else y=l.right[0];m="<em>"+l.left+"</em> ("+l.pos+") &mdash; "+y,g.push(m)}}f=DSt.get(NDS_SHORT_NAME+"-"+"digisanit-select-langpair"),M=f.split("-"),E=M[0],D=M[1],w=u(window.nds_opts.dictionaries.filter(function(e){return e.from.iso===E&&e.to.iso===D})),w?s=""+w.from.name+" → "+w.to.name:s="",(g.length===0||n.success===!1)&&r.tooltip&&(H=p("Unknown word"),g.push("<span class='tags'><em>"+p("You are using")+" "+s+"</em></span>"),n.tags.length>0&&(H=p("Meaning not found")));if(r.tooltip)return H||(H=b),P=e(o).find("a.tooltip_target"),P.popover({title:H,content:e("<p />").html(g.join("<br />")).html(),html:!0,placement:function(){return P[0].offsetLeft<125?"right":"bottom"},trigger:"hover"}),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),P.popover("show")},c=function(t,n,r,s,o){var a,f,l,c,h,p,d,v,m,g,y=this;return c=e(document).find(o.formResults),n=e.trim(n).replace(/\b[-.,()&$#!\[\]{}"]+\B|\B[-.,()&$#!\[\]{}"]+\b/g,""),n.length>60||n.search(" ")>-1?!1:(a=e(o.langPairSelect).val(),g=a.split("-"),h=g[0],p=g[1],f=n,m=u(window.nds_opts.dictionaries.filter(function(e){return e.from.iso===h&&e.to.iso===p})),m!=null?d=m.uri:d=!1,window.cp=m,l={lookup:f,lemmatize:!0},v=""+o.api_host+"/"+d,e.getJSON(v+"?callback=?",l,function(e){var t;return t={string:n,element:r,range:s},i(t,e,o)}),!1)},e.fn.selectToLookup=function(t){var i,o,u,f,h,p,d,v,m,g,y,b,w,E,S,x,T=this;return t=e.extend({},e.fn.selectToLookup.options,t),window.nds_opts=t,g=l(t.spinnerImg),d=function(){return e.getJSON(nds_opts.api_host+"/read/update/json/"+"?callback=?",function(t){return e(document).find("body").append(r.NotifyWindow(t)),e(document).find("#notifications").modal({backdrop:!0,keyboard:!0}),e("#close_modal").click(function(){return e("#notifications").modal("hide"),DSt.set(NDS_SHORT_NAME+"-"+"digisanit-select-langpair",null),DSt.set(NDS_SHORT_NAME+"-"+"nds-languages",null),DSt.set(NDS_SHORT_NAME+"-"+"nds-localization",null),DSt.set(NDS_SHORT_NAME+"-"+"nds-stored-config",null),window.location.reload(),!1})}),!1},window.newVersionNotify=d,h=function(){return e.getJSON("http://localhost:5000/read/ie8_instructions/json/?callback=?",function(t){return e(document).find("body").prepend(r.NotifyWindow(t)),e(document).find("#notifications").modal({backdrop:!0,keyboard:!0}),e("#close_modal").click(function(){return e("#notifications").modal("hide"),DSt.set(NDS_SHORT_NAME+"-"+"nds-ie8-dismissed",!0),!1})}),!0},window.ie8Notify=h,p=function(){var t,n,i,o,u,f=this;return window.nds_opts.displayOptions&&(e(document).find("body").append(r.OptionsTab(window.nds_opts)),window.optTab=e(document).find("#webdict_options"),window.optTab.css("z-index",9e3)),i=DSt.get(NDS_SHORT_NAME+"-"+"digisanit-select-langpair"),i?(u="select[name='language_pair']",o=window.optTab.find(u).val(i)):(u="select[name='language_pair']",o=window.optTab.find(u).val(),i=DSt.set(NDS_SHORT_NAME+"-"+"digisanit-select-langpair",o)),n=function(n){var r,i,o,u;return t(n),n.altKey?(r=n.target,u=e(r).parents("#webdict_options"),u.length>0?(e(u[0]).find("#debug").show(),!1):(i=a(),o=s(i),i&&o&&c(n,o,r,i,window.nds_opts),!1)):!0},t=function(t){var n;return n=[],e(document).find("a.tooltip_target").each(function(){return n.push(e(this).parent()),e(this).popover("destroy"),e(this).replaceWith(this.childNodes)}),e(document).find("a.tooltip_target").contents().unwrap()},window.cleanTooltips=t,e(document).bind("click",n)},y=function(e){return DSt.set(NDS_SHORT_NAME+"-"+"nds-languages",e.dictionaries),DSt.set(NDS_SHORT_NAME+"-"+"nds-localization",e.localization),DSt.set(NDS_SHORT_NAME+"-"+"nds-stored-config","true"),!0},o=function(e){window.r_test=e,window.nds_opts.dictionaries=e.dictionaries,window.nds_opts.localization=e.localization,y(e)},f=function(){var n;return n=""+t.api_host+"/read/config/",e.getJSON(n+"?callback=?",o)},u=function(e){return o(e),p()},m=function(){var e,t;return t=DSt.get(NDS_SHORT_NAME+"-"+"nds-localization"),typeof t=="string"&&(t=JSON.parse(t)),window.nds_opts.localization=t,e=DSt.get(NDS_SHORT_NAME+"-"+"nds-languages"),typeof e=="string"&&(e=JSON.parse(e)),window.nds_opts.dictionaries=e,p()},S=!1,window.NDS_BOOKMARK_VERSION!=null?S=semver.gte(window.NDS_BOOKMARK_VERSION,n):S=!0,w=navigator.userAgent,x=[!1,!1],v=x[0],i=x[1],__indexOf.call(w,"MSIE 8.0")>=0&&(v=!0,i=DSt.get(NDS_SHORT_NAME+"-"+"nds-ie8-dismissed")),S?(v&&(console.log("ie8 detected"),i||h()),b=DSt.get(NDS_SHORT_NAME+"-"+"nds-stored-config"),b!=null?m():(E=""+t.api_host+"/read/config/",e.getJSON(E+"?callback=?",u)),!1):(d(),!1)},e.fn.selectToLookup.options={api_host:t,formResults:"#results",spinnerImg:"/static/img/spinner.gif",sourceLanguage:"sme",langPairSelect:"#webdict_options *[name='language_pair']",tooltip:!0,displayOptions:!0,dictionaries:[{from:{iso:"sme",name:"nordsamisk"},to:{iso:"nob",name:"norsk"},uri:"/lookup/sme/nob/"}]},e.fn.digiSanit=function(t){return t=e.extend({},e.fn.digiSanit.options,t),this.each(function(){var t,n,r=this;return t=e(this),n=e(this).find("#results"),t.find('input[name="lookup"]').keydown(function(e){return e.keyCode===13?(t.submit(),!1):!0}),t.submit(function(){var i,s,o,u,a,f,l,c;return o=t.find('input[name="lookup"]').val(),s=e(r).find('input[name="target_lang"]').val(),a=s.slice(0,3),f=s.slice(3,6),u={lookup:o},o.slice(-1)==="*"&&(u.type="startswith",u.lookup=u.lookup.replace("*","")),l=function(t){return e(n).append(e('<p xml:lang="no" class="alert">'+p("Unknown word")+"</p>")),!1},i=function(t){var r,i,s,o,u,a,f;e(n).html(""),t.success===!1?l():t.result.length===1&&!t.result[0].lookups&&l(),a=t.result,f=[];for(o=0,u=a.length;o<u;o++)i=a[o],f.push(function(){var t,o,u,a;u=i.lookups,a=[];for(t=0,o=u.length;t<o;t++)r=u[t],s=r.right.join(", "),a.push(e(n).append(e("<p>"+r.left+" ("+r.pos+") &mdash; "+s+"</p>")));return a}());return f},c=""+window.nds_opts.api_host+"/lookup/"+a+"/"+f+"/",e.getJSON(c+"?callback=?",u,i),!1})})},e.fn.digiSanit.options={api_host:t,formIDName:"#digisanit",formResults:"#results"},e.fn.digiSanitTest=function(t){var n,r;return t=e.extend({},e.fn.digiSanit.options,t),n=function(e){return console.log("Can connect."),console.log(e)},r={lookup:"mannat"},e.getJSON(""+window.nds_opts.api_host+"/lookup/sme/nob/?callback=?",r,n)},e.fn.digiSanitTest.options={api_host:t,formIDName:"#digisanit",formResults:"#results"}})